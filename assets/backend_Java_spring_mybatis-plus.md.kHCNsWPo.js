import{_ as n,c as a,o as l,ah as p}from"./chunks/framework.BrJYEL96.js";const b=JSON.parse('{"title":"mybatis-plus","description":"","frontmatter":{},"headers":[],"relativePath":"backend/Java/spring/mybatis-plus.md","filePath":"backend/Java/spring/mybatis-plus.md","lastUpdated":1751927752000}'),e={name:"backend/Java/spring/mybatis-plus.md"};function o(r,s,c,t,i,y){return l(),a("div",null,s[0]||(s[0]=[p(`<h1 id="mybatis-plus" tabindex="-1">mybatis-plus <a class="header-anchor" href="#mybatis-plus" aria-label="Permalink to &quot;mybatis-plus&quot;">​</a></h1><p>xml文件不再默认的<code>resource/mapper/</code>文件夹的配置：</p><p>application.yml</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># 多模块配置</span></span>
<span class="line"><span style="color:#E06C75;">mybatis-plus</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">  mapper-locations</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    - </span><span style="color:#98C379;">classpath*:com/imooc/news_manager_project/mapper/*.xml</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 单模块配置</span></span>
<span class="line"><span style="color:#E06C75;">mybatis-plus</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">  mapper-locations</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    - </span><span style="color:#98C379;">com/imooc/news_manager_project/mapper/*.xml</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>pox.xml</p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">build</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">resources</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">resource</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">directory</span><span style="color:#ABB2BF;">&gt;src/main/java&lt;/</span><span style="color:#E06C75;">directory</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">includes</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">include</span><span style="color:#ABB2BF;">&gt;**/*.xml&lt;/</span><span style="color:#E06C75;">include</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#7F848E;font-style:italic;">&lt;!-- 包含 Java 目录下的 XML 文件 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">includes</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;/</span><span style="color:#E06C75;">resource</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">resource</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">directory</span><span style="color:#ABB2BF;">&gt;src/main/resources&lt;/</span><span style="color:#E06C75;">directory</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#7F848E;font-style:italic;">&lt;!-- 保留对 resources 目录的扫描 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;/</span><span style="color:#E06C75;">resource</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E06C75;">resources</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">build</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="其它操作数据模式" tabindex="-1">其它操作数据模式 <a class="header-anchor" href="#其它操作数据模式" aria-label="Permalink to &quot;其它操作数据模式&quot;">​</a></h3><h4 id="ar模式" tabindex="-1">AR模式 <a class="header-anchor" href="#ar模式" aria-label="Permalink to &quot;AR模式&quot;">​</a></h4><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">//需要继承MP的Model类， 同时需要HuMapper 继承BaseMapper</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> class</span><span style="color:#E5C07B;"> Hu</span><span style="color:#C678DD;">  extends</span><span style="color:#E5C07B;"> Model</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Hu</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="service通用" tabindex="-1">Service通用 <a class="header-anchor" href="#service通用" aria-label="Permalink to &quot;Service通用&quot;">​</a></h4><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">//UserService</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> interface</span><span style="color:#E5C07B;"> UserService</span><span style="color:#C678DD;"> extends</span><span style="color:#E5C07B;"> IService</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">User</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//UserServiceImpl</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Service</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> class</span><span style="color:#E5C07B;"> UserServiceImpl</span><span style="color:#C678DD;"> extends</span><span style="color:#E5C07B;"> ServiceImpl</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">UserMapper</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;"> User</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#C678DD;"> implements</span><span style="color:#E5C07B;"> UserService</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="逻辑删除" tabindex="-1">逻辑删除 <a class="header-anchor" href="#逻辑删除" aria-label="Permalink to &quot;逻辑删除&quot;">​</a></h4><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;">mybatis-plus</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">  mapper-locations</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">classpath*:com/mp/mapper/*.xml</span></span>
<span class="line"><span style="color:#E06C75;">  type-aliases-package</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">com.mp.entity</span></span>
<span class="line"><span style="color:#E06C75;">  global-config</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">    db-config</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">      logic-delete-value</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span></span>
<span class="line"><span style="color:#E06C75;">      logic-not-delete-value</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>实体类</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 逻辑删除</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">TableLogic</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">TableField</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">select</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> false</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#C678DD;">private</span><span style="color:#E5C07B;"> Integer</span><span style="color:#E06C75;"> deleted</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="自动填充" tabindex="-1">自动填充 <a class="header-anchor" href="#自动填充" aria-label="Permalink to &quot;自动填充&quot;">​</a></h4><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">//User实体类</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 创建时间</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">TableField</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">fill</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> FieldFill</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">INSERT</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#C678DD;">private</span><span style="color:#E5C07B;"> LocalDateTime</span><span style="color:#E06C75;"> createTime</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 更新时间</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">TableField</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">fill</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> FieldFill</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">INSERT_UPDATE</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#C678DD;">private</span><span style="color:#E5C07B;"> LocalDateTime</span><span style="color:#E06C75;"> updateTime</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>MyMetaObjectHandler.java</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">package</span><span style="color:#C678DD;"> com.mp.component</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E5C07B;"> com.baomidou.mybatisplus.core.handlers.MetaObjectHandler</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E5C07B;"> org.apache.ibatis.reflection.MetaObject</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E5C07B;"> org.springframework.stereotype.Component</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E5C07B;"> java.time.LocalDateTime</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Component</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> class</span><span style="color:#E5C07B;"> MyMetaObjectHandler</span><span style="color:#C678DD;"> implements</span><span style="color:#E5C07B;"> MetaObjectHandler</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> insertFill</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">MetaObject</span><span style="color:#E06C75;font-style:italic;"> metaObject</span><span style="color:#ABB2BF;">)</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">        boolean</span><span style="color:#E06C75;"> hasSetter</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> metaObject</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hasSetter</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;createTime&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (hasSetter) {</span></span>
<span class="line"><span style="color:#61AFEF;">            setInsertFieldValByName</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;createTime&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">LocalDateTime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">(), metaObject);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> updateFill</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">MetaObject</span><span style="color:#E06C75;font-style:italic;"> metaObject</span><span style="color:#ABB2BF;">)</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">        boolean</span><span style="color:#E06C75;"> hasSetter</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> metaObject</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hasSetter</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;updateTime&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">        Object</span><span style="color:#E06C75;"> updateTime</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> getFieldValByName</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;updateTime&quot;</span><span style="color:#ABB2BF;">, metaObject);</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (hasSetter </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> updateTime </span><span style="color:#56B6C2;">==</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">            System</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">out</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;走update&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">            setUpdateFieldValByName</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;updateTime&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">LocalDateTime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">(), metaObject);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">            System</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">out</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;不走update&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h4 id="乐观锁" tabindex="-1">乐观锁 <a class="header-anchor" href="#乐观锁" aria-label="Permalink to &quot;乐观锁&quot;">​</a></h4><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">package</span><span style="color:#C678DD;"> com.mp.configuration</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E5C07B;"> com.baomidou.mybatisplus.extension.plugins.OptimisticLockerInterceptor</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E5C07B;"> com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E5C07B;"> org.springframework.context.annotation.Bean</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E5C07B;"> org.springframework.context.annotation.Configuration</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Configuration</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> class</span><span style="color:#E5C07B;"> MybatisPlusConfiguration</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     * 分页插件</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     * </span><span style="color:#C678DD;font-style:italic;">@return</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     */</span></span>
<span class="line"><span style="color:#ABB2BF;">    @</span><span style="color:#E5C07B;">Bean</span></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#E5C07B;"> PaginationInterceptor</span><span style="color:#61AFEF;"> paginationInterceptor</span><span style="color:#ABB2BF;">()</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> PaginationInterceptor</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     * 乐观锁</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     * </span><span style="color:#C678DD;font-style:italic;">@return</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     */</span></span>
<span class="line"><span style="color:#ABB2BF;">    @</span><span style="color:#E5C07B;">Bean</span></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#E5C07B;"> OptimisticLockerInterceptor</span><span style="color:#61AFEF;"> optimisticLockerInterceptor</span><span style="color:#ABB2BF;">()</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> OptimisticLockerInterceptor</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h4 id="性能检测" tabindex="-1">性能检测 <a class="header-anchor" href="#性能检测" aria-label="Permalink to &quot;性能检测&quot;">​</a></h4><p><strong>使用 P6Spy</strong></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">dependency</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">groupId</span><span style="color:#ABB2BF;">&gt;p6spy&lt;/</span><span style="color:#E06C75;">groupId</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">artifactId</span><span style="color:#ABB2BF;">&gt;p6spy&lt;/</span><span style="color:#E06C75;">artifactId</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">&gt;3.8.2&lt;/</span><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">dependency</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;">spring</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">  datasource</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    #    driver-class-name: com.mysql.cj.jdbc.Driver</span></span>
<span class="line"><span style="color:#E06C75;">    driver-class-name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">com.p6spy.engine.spy.P6SpyDriver</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#    url: jdbc:mysql://mysql2.sqlpub.com:3307/db_user_manager?serverTimezone=Asia/Shanghai</span></span>
<span class="line"><span style="color:#E06C75;">    url</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">jdbc:p6spy:mysql://mysql2.sqlpub.com:3307/db_user_manager?serverTimezone=Asia/Shanghai</span></span>
<span class="line"><span style="color:#E06C75;">    username</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">dotohi</span></span>
<span class="line"><span style="color:#E06C75;">    password</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">UOlfBuHB092V</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>配置 <code>spy.properties</code>：</p><div class="language-properties line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#appender=com.p6spy.engine.spy.appender.Slf4JLogger</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#logMessageFormat=com.p6spy.engine.spy.appender.CustomLineFormat</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 自定义日志扫描</span></span>
<span class="line"><span style="color:#C678DD;">module.log</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">com.p6spy.engine.logging.P6LogFactory,com.p6spy.engine.outage.P6OutageFactory</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 自定义日志打印</span></span>
<span class="line"><span style="color:#C678DD;">logMessageFormat</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">com.baomidou.mybatisplus.extension.p6spy.P6SpyLogger</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#日志输出到控制台</span></span>
<span class="line"><span style="color:#C678DD;">appender</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">com.baomidou.mybatisplus.extension.p6spy.StdoutLogger</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 使用日志系统记录SQL</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#appender=com.p6spy.engine.spy.appender.slf4j.Slf4JLogger</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 设置p6spy driver 代理</span></span>
<span class="line"><span style="color:#C678DD;">deregisterdrivers</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">true</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 取消JDBC URL前缀</span></span>
<span class="line"><span style="color:#C678DD;">useprefix</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">true</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 配置记录log 例外， 可去掉的结果有error,info,batch,debug,statement,commit,rollback,result,resultset</span></span>
<span class="line"><span style="color:#C678DD;">excludecategories</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">info,debug,result,resultset,batch</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 日期格式</span></span>
<span class="line"><span style="color:#C678DD;">dateformat</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">yyyy-MM-dd HH:mm:ss</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 实际驱动可多个</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#driverlist=org.h2.Driver</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 是否开启慢SQL记录</span></span>
<span class="line"><span style="color:#C678DD;">outagedetection</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">true</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 慢SQL记录标准 2 秒</span></span>
<span class="line"><span style="color:#C678DD;">outagedetectioninterval</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">2</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#日志输出到文件</span></span>
<span class="line"><span style="color:#C678DD;">logfile</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">spy.log</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div>`,27)]))}const u=n(e,[["render",o]]);export{b as __pageData,u as default};
