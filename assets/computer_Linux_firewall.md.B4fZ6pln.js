import{_ as a,c as e,o as n,ah as l}from"./chunks/framework.BrJYEL96.js";const u=JSON.parse('{"title":"防火墙","description":"","frontmatter":{},"headers":[],"relativePath":"computer/Linux/firewall.md","filePath":"computer/Linux/firewall.md","lastUpdated":1754837914000}'),o={name:"computer/Linux/firewall.md"};function p(r,s,c,t,i,d){return n(),e("div",null,s[0]||(s[0]=[l(`<h1 id="防火墙" tabindex="-1">防火墙 <a class="header-anchor" href="#防火墙" aria-label="Permalink to &quot;防火墙&quot;">​</a></h1><table tabindex="0"><thead><tr><th>web</th><th>des</th></tr></thead><tbody><tr><td><a href="https://blog.csdn.net/qq_38628046/article/details/135688606" target="_blank" rel="noreferrer">防火墙</a></td><td></td></tr></tbody></table><h2 id="firewalled" tabindex="-1">firewalled <a class="header-anchor" href="#firewalled" aria-label="Permalink to &quot;firewalled&quot;">​</a></h2><p>在CentOS 7中，默认使用的是<code>firewalld</code>作为防火墙管理工具</p><h3 id="置默认区域" tabindex="-1">置默认区域 <a class="header-anchor" href="#置默认区域" aria-label="Permalink to &quot;置默认区域&quot;">​</a></h3><p>CentOS 7中的firewalld将网络接口分配到不同的区域。下面是一些常见的区域及其用途：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">public：用于公共网络，通常是不受信任的网络</span></span>
<span class="line"><span style="color:#61AFEF;">trusted：用于受信任的网络，例如内部网络</span></span>
<span class="line"><span style="color:#61AFEF;">home：用于家庭网络</span></span>
<span class="line"><span style="color:#61AFEF;">work：用于工作网络</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>查看当前的默认区域：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --get-default-zone</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>设置默认区域：将 <code>&lt;zone&gt; </code>替换为希望设置为默认的区域。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --set-default-zone=</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#D19A66;">zone</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="查看防火墙状态和规则" tabindex="-1">查看防火墙状态和规则 <a class="header-anchor" href="#查看防火墙状态和规则" aria-label="Permalink to &quot;查看防火墙状态和规则&quot;">​</a></h3><h4 id="查看防火墙状态" tabindex="-1">查看防火墙状态 <a class="header-anchor" href="#查看防火墙状态" aria-label="Permalink to &quot;查看防火墙状态&quot;">​</a></h4><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --state</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="使用firewall-config图形界面-可选" tabindex="-1">使用<code>firewall-config</code>图形界面（可选） <a class="header-anchor" href="#使用firewall-config图形界面-可选" aria-label="Permalink to &quot;使用\`firewall-config\`图形界面（可选）&quot;">​</a></h4><h4 id="检查开放的端口" tabindex="-1">检查开放的端口 <a class="header-anchor" href="#检查开放的端口" aria-label="Permalink to &quot;检查开放的端口&quot;">​</a></h4><p>要检查哪些端口已经被开放，可以使用以下命令：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --zone=public</span><span style="color:#D19A66;"> --list-ports</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>查看特定区域的规则：将 <code>&lt;zone&gt;</code> 替换为要查看的区域名称。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --zone=</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#D19A66;">zone</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#D19A66;"> --list-all</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="添加和删除规则" tabindex="-1">添加和删除规则 <a class="header-anchor" href="#添加和删除规则" aria-label="Permalink to &quot;添加和删除规则&quot;">​</a></h3><p>添加开放端口规则：</p><blockquote><p>将在公共区域添加一个开放的TCP端口规则。将<code>&lt;zone&gt;</code>替换为要添加规则的区域名称，将<code>&lt;port&gt;</code>替换为实际的端口号。</p></blockquote><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --zone=</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#D19A66;">zone</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#D19A66;"> --add-port=</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#D19A66;">port</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#D19A66;">/tcp</span><span style="color:#D19A66;"> --permanent</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --zone=public</span><span style="color:#D19A66;"> --add-port=80/tcp</span><span style="color:#D19A66;"> --permanent</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --reload</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>添加允许指定服务的规则：</p><blockquote><p>将在公共区域添加一个允许指定服务的规则。将<code>&lt;zone&gt;</code>替换为要添加规则的区域名称，将 <code>&lt;service&gt; </code>替换为实际的服务名称，例如 http。</p></blockquote><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --zone=</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#D19A66;">zone</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#D19A66;"> --add-service=</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#D19A66;">service</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#D19A66;"> --permanent</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --zone=public</span><span style="color:#D19A66;"> --add-service=redis</span><span style="color:#D19A66;"> --permanent</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --reload</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>删除规则：</p><blockquote><p>将从公共区域永久删除指定的规则。将<code>&lt;zone&gt;</code>替换为要添加规则的区域名称，将<code>&lt;rule&gt;</code>替换为实际要删除的规则。</p></blockquote><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --zone=</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#D19A66;">zone</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#D19A66;"> --remove-rule=</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#D19A66;">rule</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#D19A66;"> --permanent</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="重新加载和永久生效配置" tabindex="-1">重新加载和永久生效配置 <a class="header-anchor" href="#重新加载和永久生效配置" aria-label="Permalink to &quot;重新加载和永久生效配置&quot;">​</a></h3><p>重新加载防火墙配置：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --reload</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>永久生效配置：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> firewall-cmd</span><span style="color:#D19A66;"> --runtime-to-permanent</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="iptables" tabindex="-1">iptables <a class="header-anchor" href="#iptables" aria-label="Permalink to &quot;iptables&quot;">​</a></h2><p>centos和Ubuntu都有的防火墙规则</p><h3 id="使用-iptables" tabindex="-1">使用 iptables <a class="header-anchor" href="#使用-iptables" aria-label="Permalink to &quot;使用 iptables&quot;">​</a></h3><ol><li><p><strong>安装 iptables 服务（如果尚未安装）</strong></p><p>通常CentOS 7及以下版本默认安装了<code>iptables</code>服务，但在CentOS 8中默认使用<code>firewalld</code>。如果你确实需要使用<code>iptables</code>，可以尝试以下命令：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> yum</span><span style="color:#98C379;"> install</span><span style="color:#98C379;"> iptables-services</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p><strong>启动 iptables 服务</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> systemctl</span><span style="color:#98C379;"> start</span><span style="color:#98C379;"> iptables</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p><strong>设置 iptables 开机自启</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> systemctl</span><span style="color:#98C379;"> enable</span><span style="color:#98C379;"> iptables</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p><strong>查看当前 iptables 规则</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> iptables</span><span style="color:#D19A66;"> -L</span><span style="color:#D19A66;"> -v</span><span style="color:#D19A66;"> -n</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p><strong>开放端口</strong></p><p>例如，开放端口 80：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> iptables</span><span style="color:#D19A66;"> -I</span><span style="color:#98C379;"> INPUT</span><span style="color:#D19A66;"> -p</span><span style="color:#98C379;"> tcp</span><span style="color:#D19A66;"> --dport</span><span style="color:#D19A66;"> 80</span><span style="color:#D19A66;"> -j</span><span style="color:#98C379;"> ACCEPT</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>保存规则（取决于你的系统版本，可能需要额外的步骤）：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> service</span><span style="color:#98C379;"> iptables</span><span style="color:#98C379;"> save</span><span style="color:#7F848E;font-style:italic;">  # CentOS 6 或较老版本的系统可能需要此命令保存规则，CentOS 7 使用 firewalld。在 CentOS 8 中通常不需要这一步，因为规则会持久化。</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p><strong>重新加载 iptables 以应用更改</strong>（在某些系统上不需要此步骤）:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#98C379;"> systemctl</span><span style="color:#98C379;"> restart</span><span style="color:#98C379;"> iptables</span><span style="color:#7F848E;font-style:italic;">  # 在 CentOS 7 或 CentOS 8 使用 firewalld 时，这一步通常不需要。在 CentOS 6 或较老版本中可能需要。</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ol>`,39)]))}const y=a(o,[["render",p]]);export{u as __pageData,y as default};
